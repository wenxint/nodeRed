// cs protocol
syntax = "proto3";

package zonepb.loadoutpb;
option go_package = "git.code.oa.com/red/zonesvr/pkg/proto/zonepb/loadoutpb";

import "corepb/loadout_comm.proto";
import "corepb/fight_common.proto";

service Service {
  rpc LoadoutInfo(LoadoutInfoRequest) returns (LoadoutInfoReply);                                   // 获取阵容信息
  rpc ApplyLoadout(ApplyLoadoutRequest) returns (ApplyLoadoutReply);                                // 设置阵容
  rpc ApplyDial(ApplyDialRequest) returns (ApplyDialReply);                                         // 设置阵容的空岛贝
  rpc RemoveCandidateNewTags(RemoveCandidateNewTagsRequest) returns (RemoveCandidateNewTagsReply);  // 移除候选「新」标签
  rpc LimitFreeInfo(LimitFreeInfoRequest) returns (LimitFreeInfoReply);                             // 获取限免信息
}

// LoadoutInfo

message LoadoutInfoRequest {
  string loadout_type = 1;  // 阵容类型。具体有哪些值由玩法系统确定
}

message LoadoutInfoReply {
  corepb.LoadoutProfile profile = 1;  // 阵容配置
  corepb.Loadout loadout        = 2;  // 阵容
  bool valid                    = 3;  // 当前阵容是否合法
  bool adjusted                 = 4;  // 当前阵容检验时是否有过不合法的项目但已经被自动调整
}

// ApplyLoadout

message ApplyLoadoutRequest {
  string loadout_type    = 1;  // 阵容类型。具体有哪些值由玩法系统确定
  corepb.Loadout loadout = 2;  // 阵容
}

message ApplyLoadoutReply {
  // 若要设置的阵容不合法，会通过 rpc 错误告知。
}

// ApplyDial
message ApplyDialRequest {
  string loadout_type                            = 1;  // 阵容类型。具体有哪些值由玩法系统确定
  repeated corepb.LoadoutDialChoice dial_choices = 2;
}

message ApplyDialReply {}

// NTF

// LoadoutChangeNTF 在有阵容变更时发送
message LoadoutChangeNTF {
  string loadout_type    = 1;  // 阵容类型。具体有哪些值由玩法系统确定
  corepb.Loadout loadout = 2;  // 阵容
}

message RemoveCandidateNewTagsRequest {
  bool remove_dial          = 1;  // 移除空岛贝「新」标签
  bool remove_fight_buddy   = 2;  // 移除出战伙伴「新」标签
  bool remove_support_buddy = 3;  // 移除援护伙伴「新」标签
  bool remove_warship       = 4;  // 移除战船「新」标签
  bool remove_ship_skill    = 5;  // 移除船技「新」标签
}

message RemoveCandidateNewTagsReply {}

message LimitFreeInfoRequest {
  string loadout_type = 1;  // 阵容类型。具体有哪些值由玩法系统确定
}

message LimitFreeBuddy {
  int64 buddy_id = 1;  // 伙伴ID
  int64 star     = 2;  // 星级
}

message LimitFreeDial {
  int64 dial_id                = 1;  // 空岛贝ID
  int64 level                  = 2;  // 空岛贝等级
  corepb.FightSkill skill_info = 3;  // 技能相关信息
}

message LimitFreeInfoReply {
  repeated LimitFreeBuddy buddies  = 1;  // 限免伙伴列表
  repeated LimitFreeBuddy supports = 2;  // 限免援护列表
  repeated LimitFreeDial dials     = 3;  // 限免空岛贝列表
  string tips                      = 4;  // 限免提示
}