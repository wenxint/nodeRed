// cs protocol
syntax = "proto3";

package actpb.act0176pb;
option go_package = "git.woa.com/red/actsvr/pkg/proto/actpb/act0176pb";

import "corepb/common.proto";
import "pkg/proto/actpb/commonpb/common.proto";

// copy from internal/pkg/msapp/actsvr/service/act0176/config/config.proto
enum PartsType {
  PT_UNKNOWN = 0;  // 占位
  PT_BOW     = 1;  // 船头
  PT_ANCHOR  = 2;  // 船锚
  PT_MAIN    = 3;  // 主船帆和主桅杆
  PT_STERN   = 4;  // 尾帆和副桅杆
  PT_CABIN   = 5;  // 测量室
  PT_SONNY   = 6;  // 桑尼号
}

// rpc ActGetDetail 活动详情使用通用协议
message ActGetDetailRequest {}
message ActGetDetailReply {
  int64 contribute                              = 1;  // 个人贡献值
  int64 progress                                = 2;  // 当前进度 精确到万分比
  repeated ProgressInfo progress_tasks          = 3;  // 阶段进度列表,按阶段ID递增排序
  repeated actpb.commonpb.Task contribute_tasks = 4;  // 贡献奖励展示,按材料道具ID递增排序
  string rank_type                              = 5;  // 排行榜类型
  string rank_instance                          = 6;  // 排行榜实例名
  repeated int64 collection_ids                 = 7;  // 藏品对应阶段ID列表,空的话说明无藏品
  bool is_liked                                 = 8;  // 当天是否点赞过
}

// 任务完成进度信息
message ProgressInfo {
  int64 id                         = 1;  // 阶段ID
  string name                      = 2;  // 阶段标题
  string desc                      = 3;  // 阶段描述
  int64 target                     = 4;  // 阶段目标进度
  repeated corepb.Item awards      = 5;  // 进度奖励
  actpb.commonpb.TaskStatus status = 6;  // 阶段状态
  PartsType parts                  = 7;  // 对应部件
}

message ActDeliverRewardRequest {}
message ActDeliverRewardReply {}

service CSAct0176Service {
  rpc Like(LikeRequest) returns (LikeReply);                                   // 点赞
  rpc Contribute(ContributeRequest) returns (ContributeReply);                 // 一键贡献
  rpc CollectionAward(CollectionAwardRequest) returns (CollectionAwardReply);  // 领取藏品
}

message LikeRequest {
  int64 id = 1;  // 点赞对象ID
}
message LikeReply {}

message ContributeRequest {}
message ContributeReply {
  repeated corepb.Item awards = 2;  // 贡献奖励
}

message CollectionAwardRequest {
  int64 id = 1;  // 藏品对应阶段ID
}
message CollectionAwardReply {
  repeated corepb.Item awards = 2;  // 藏品奖励
}
